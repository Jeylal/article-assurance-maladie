setwd("~/GitHub/celalguney/posts/assurance_maladie/data")
votations2024 <- read_excel("votations2024.xlsx",
col_types = c("numeric", "text", "numeric",
"numeric"))
library(tidyverse)
library(readr)
votations2024 <- read_excel("votations2024.xlsx",
col_types = c("numeric", "text", "numeric",
"numeric"))
afc_chiffrescles_2022 <- read_excel("afc_chiffrescles_2022.xlsx",
sheet = "Gemeinden - Communes")
votations2024 <- read_excel("votations2024.xlsx",
col_types = c("numeric", "text", "numeric",
"numeric"))
library(readxl)
votations2024 <- read_excel("votations2024.xlsx",
col_types = c("numeric", "text", "numeric",
"numeric"))
View(votations2024)
library(readxl)
afc_chiffrescles_2022 <- read_excel("afc_chiffrescles_2022.xlsx",
sheet = "Gemeinden - Communes")
View(afc_chiffrescles_2022)
data = votations2024 %>%
left_join(afc_chiffrescles_2022, by = c("Gemeindenummer" = "Gemeindenummer\r\nCode commune"))
View(data)
communes_sf <- bfs_get_base_maps(geom = "polg", date = "20240101")
communes_sf$id = as.numeric(communes_sf$id)
datamap = communes_sf %>%
left_join(data, by = c("name" = "Gemeinde\r\nCommune"))
datamap %>%
ggplot()+
geom_sf(aes(fill = allegement_primes_oui))+
scale_fill_viridis_b()
View(data)
datamap = communes_sf %>%
left_join(data, by = c("Gemeindenummer" = "id"))
View(data)
names(data)
datamap = data %>%
left_join(communes_sf, by = c("Gemeindenummer" = "id"))
datamap %>%
ggplot()+
geom_sf(aes(fill = allegement_primes_oui))+
scale_fill_viridis_b()
View(datamap)
datamap %>%
ggplot()+
geom_sf()
View(datamap)
View(communes_sf)
View(datamap)
datamap %>%
ggplot()+
geom_sf(aes(geometry = geometry))
datamap %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = allegement_primes_oui))
datamap %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = allegement_primes_oui))+
scale_fill_viridis_b()
datamap %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = allegement_primes_oui))+
theme_void()+
scale_fill_viridis_b()
datamap %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = allegement_primes_oui))+
theme_void()+
scale_fill_viridis_b()+
theme(legend.position = "bottom")
install.packages("mapview")
library(mapview)
datamap %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = allegement_primes_oui))+
theme_void()+
scale_fill_viridis_b()+
theme(legend.position = "bottom") %>%
mapview()
datamap %>%
mapview()
communes_sf %>%
mapview()
datamap %>%
mapview(x = geometry)
View(datamap)
communes_sf %>%
mapview()
View(datamap)
library(readxl)
efas_votation_commune <- read_excel("efas_votation_commune.xlsx",
skip = 4)
View(efas_votation_commune)
efas_votation_commune[, c(1, 3, 4, 13)]
datamap2 = datamap %>%
left_join(efas_votation_commune[, c(1, 3, 4, 13)], by = c("Gemeindenummer" = "No commune"))
View(datamap2)
datamap2 = datamap %>%
left_join(efas_votation_commune[, c(1, 3, 4, 13)], by = c("Gemeindenummer" = "No commune")) %>%
rename("efas_oui" = `Oui en %`)
View(datamap2)
datamap2 %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = efas_oui))+
theme_void()+
scale_fill_viridis_b()+
theme(legend.position = "bottom")
datamap2 %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = efas_oui))+
theme_void()+
scale_fill_viridis_c()+
theme(legend.position = "bottom")
datamap2 %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = efas_oui))+
theme_void()+
scale_fill_viridis_c(option = "T")+
theme(legend.position = "bottom")
datamap2 %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = efas_oui))+
theme_void()+
scale_fill_viridis_c(option = "Turbo")+
theme(legend.position = "bottom")
datamap2 %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = efas_oui))+
theme_void()+
scale_fill_viridis_c(option = "turbo")+
theme(legend.position = "bottom")
datamap2 %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = efas_oui))+
theme_void()+
scale_fill_viridis_c(option = "turbo", direction = -1)+
theme(legend.position = "bottom")
install.packages("biscale")
library(biscale)
View(datamap2)
biclass = bi_class(datamap2, x = median_reinka, y = efas_oui, dim = 3)
biclass = bi_class(datamap2, x = median_reinka, y = efas_oui, dim = 3, na_rm = TRUE)
biclass = bi_class(datamap2, x = median_reinka, y = efas_oui, style = "quantile", dim = 3, na_rm = TRUE)
datamap2 %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = biclass))+
theme_void()+
scale_fill_viridis_c(option = "turbo", direction = -1)+
theme(legend.position = "bottom")
View(biclass)
ggplot() +
geom_sf(data = biclass, mapping = aes(fill = bi_class), color = "white", size = 0.1, show.legend = FALSE) +
bi_scale_fill(pal = "GrPink", dim = 3)
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = FALSE) +
bi_scale_fill(pal = "GrPink", dim = 3)
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = T) +
bi_scale_fill(pal = "GrPink", dim = 3)
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = T) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme()
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme()
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Higher median income ",
ylab = "Higher yes in % ",
size = 8)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme()
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Higher median income ",
ylab = "Higher yes in % ",
size = 8)
finalPlot <- ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.2, .65, 0.2, 0.2)
install.packages("ggdraw")
library(ggdraw)
install.packages("cowplot")
library(cowplot)
finalPlot <- ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.2, .65, 0.2, 0.2)
finalPlot
finalPlot <- ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.1, .65, 0.2, 0.2)
finalPlot
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.1, .65, 0.2, 0.2)+
labs(title = "MDR")
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme()+
labs(
title = "Votation sur le Financement uniforme des prestations de santé"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Higher median income ",
ylab = "Higher yes in % ",
size = 8)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.1, .65, 0.2, 0.2)+
labs(title = "MDR")
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(size = 1)+
labs(
title = "Votation sur le Financement uniforme des prestations de santé"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Higher median income ",
ylab = "Higher yes in % ",
size = 8)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.1, .65, 0.2, 0.2)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(size = 0.2)+
labs(
title = "Votation sur le Financement uniforme des prestations de santé"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Higher median income ",
ylab = "Higher yes in % ",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.1, .65, 0.2, 0.2)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(base_size = 15)+
labs(
title = "Votation sur le Financement uniforme des prestations de santé"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Higher median income ",
ylab = "Higher yes in % ",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.1, .65, 0.2, 0.2)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(base_size = 10)+
labs(
title = "Votation sur le Financement uniforme des prestations de santé"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Higher median income ",
ylab = "Higher yes in % ",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.1, .65, 0.2, 0.2)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(base_size = 10)+
labs(
title = "Votation sur le Financement uniforme des prestations de santé",
caption = "Source: OFS"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Higher median income ",
ylab = "Higher yes in % ",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.1, .65, 0.2, 0.2)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.05, .65, 0.2, 0.2)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Revenu médian",
ylab = "Oui en %",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.05, .65, 0.2, 0.2)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "PurpleOr", dim = 3) +
bi_theme(base_size = 10)+
labs(
title = "Votation sur le Financement uniforme des prestations de santé",
caption = "Source: OFS"
)
legend <- bi_legend(pal = "PurpleOr",
dim = 3,
xlab = "Revenu médian",
ylab = "Oui en %",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.05, .65, 0.2, 0.2)
datamap2 = efas_votation_commune[, c(1, 3, 4, 13)] %>%
left_join(datamap, by = c("No commune" = "Gemeindenummer")) %>%
rename("efas_oui" = `Oui en %`)
datamap2 %>%
ggplot()+
geom_sf(aes(geometry = geometry, fill = efas_oui))+
theme_void()+
scale_fill_viridis_c(option = "turbo", direction = -1)+
theme(legend.position = "bottom")
biclass = bi_class(datamap2, x = median_reinka, y = efas_oui, style = "quantile", dim = 3, na_rm = TRUE)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(base_size = 10)+
labs(
title = "Votation sur le Financement uniforme des prestations de santé",
caption = "Source: OFS"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Revenu médian",
ylab = "Oui en %",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.05, .65, 0.2, 0.2)
View(datamap2)
library(readxl)
efas_votation_commune <- read_excel("efas_votation_commune.xlsx",
skip = 4)
View(efas_votation_commune)
datamap2 = efas_votation_commune[, c(1, 3, 4, 13)] %>%
left_join(datamap, by = c("No commune" = "Gemeindenummer")) %>%
rename("efas_oui" = `Oui en %`)
View(datamap2)
biclass = bi_class(datamap2, x = median_reinka, y = efas_oui, style = "quantile", dim = 3, na_rm = TRUE)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(base_size = 10)+
labs(
title = "Votation sur le Financement uniforme des prestations de santé",
caption = "Source: OFS"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Revenu médian",
ylab = "Oui en %",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.05, .65, 0.2, 0.2)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(base_size = 10)+
labs(
title = "Votation sur le Financement uniforme des prestations de santé",
caption = " Pour chaque commune, le pourcentage de oui à la votation de novembre 2024 sur l'uniformation du financement des prestations de santé. Le revenu médian correspond à la médiane du revenu équivalent net, en francs. Source: OFS"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Revenu médian",
ylab = "Oui en %",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.05, .65, 0.2, 0.2)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(base_size = 10)+
labs(
title = "Votation sur le Financement uniforme des prestations de santé",
caption = " Pour chaque commune, le pourcentage de oui à la votation de novembre 2024
sur l'uniformation du financement des prestations de santé.
Le revenu médian correspond à la médiane du revenu équivalent net, en francs. Source: OFS"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Revenu médian",
ylab = "Oui en %",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.05, .65, 0.2, 0.2)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(base_size = 10)+
labs(
title = "Votation sur le Financement uniforme des prestations de santé",
caption = " Pour chaque commune, le pourcentage de oui à la votation de novembre 2024
sur l'uniformation du financement des prestations de santé.
Le revenu médian correspond à la médiane du revenu équivalent net en 2022 (en franc). Source: OFS"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Revenu médian",
ylab = "Oui en %",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.05, .65, 0.2, 0.2)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(base_size = 10)+
labs(
title = "Votation sur le financement uniforme des prestations de santé",
caption = " Pour chaque commune, le pourcentage de oui à la votation de novembre 2024
sur l'uniformation du financement des prestations de santé.
Le revenu médian correspond à la médiane du revenu équivalent net en 2022 (en franc). Source: OFS"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Revenu médian",
ylab = "Oui en %",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.05, .65, 0.2, 0.2)
biclass = bi_class(datamap2, x = gini_reinka, y = efas_oui, style = "quantile", dim = 3, na_rm = TRUE)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(base_size = 10)+
labs(
title = "Votation sur le financement uniforme des prestations de santé",
caption = " Pour chaque commune, le pourcentage de oui à la votation de novembre 2024
sur l'uniformation du financement des prestations de santé.
Le revenu médian correspond à la médiane du revenu équivalent net en 2022 (en franc). Source: OFS"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Revenu médian",
ylab = "Oui en %",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.05, .65, 0.2, 0.2)
biclass = bi_class(datamap2, x = median_reinka, y = efas_oui, style = "quantile", dim = 3, na_rm = TRUE)
bimap =
ggplot() +
geom_sf(data = biclass, mapping = aes(geometry = geometry, fill = bi_class), color = "white", size = 0.1, show.legend = F) +
bi_scale_fill(pal = "GrPink", dim = 3) +
bi_theme(base_size = 10)+
labs(
title = "Votation sur le financement uniforme des prestations de santé",
caption = " Pour chaque commune, le pourcentage de oui à la votation de novembre 2024
sur l'uniformation du financement des prestations de santé.
Le revenu médian correspond à la médiane du revenu équivalent net en 2022 (en franc). Source: OFS"
)
legend <- bi_legend(pal = "GrPink",
dim = 3,
xlab = "Revenu médian",
ylab = "Oui en %",
size = 8)
library(cowplot)
ggdraw() +
draw_plot(bimap, 0, 0, 1, 1) +
draw_plot(legend, 0.05, .65, 0.2, 0.2)
